/*!
 * Copyright (c) 2012, 2018 Matthias Ferch
 *
 * Project homepage: https://github.com/matthiasferch/tsm
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *    1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 *    2. Altered source versions must be plainly marked as such, and must not
 *    be misrepresented as being the original software.
 *
 *    3. This notice may not be removed or altered from any source
 *    distribution.
 */

!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s(t.tsm={})}(this,function(t){"use strict";var s=function(){function t(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}return Object.defineProperty(t.prototype,"x",{get:function(){return this.values[0]},set:function(t){this.values[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.values[1]},set:function(t){this.values[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.values[2]},set:function(t){this.values[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this.values[3]},set:function(t){this.values[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xyzw",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"r",{get:function(){return this.values[0]},set:function(t){this.values[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this.values[1]},set:function(t){this.values[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.values[2]},set:function(t){this.values[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"a",{get:function(){return this.values[3]},set:function(t){this.values[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rg",{get:function(){return[this.values[0],this.values[1]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rgb",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rgba",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]},enumerable:!0,configurable:!0}),t.prototype.at=function(t){return this.values[t]},t.prototype.reset=function(){this.x=0,this.y=0,this.z=0,this.w=0},t.prototype.copy=function(s){return s||(s=new t),s.x=this.x,s.y=this.y,s.z=this.z,s.w=this.w,s},t.prototype.negate=function(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t},t.prototype.equals=function(t,s){return void 0===s&&(s=1e-5),!(Math.abs(this.x-t.x)>s)&&(!(Math.abs(this.y-t.y)>s)&&(!(Math.abs(this.z-t.z)>s)&&!(Math.abs(this.w-t.w)>s)))},t.prototype.length=function(){return Math.sqrt(this.squaredLength())},t.prototype.squaredLength=function(){var t=this.x,s=this.y,e=this.z,i=this.w;return t*t+s*s+e*e+i*i},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},t.prototype.scale=function(t,s){return s||(s=this),s.x*=t,s.y*=t,s.z*=t,s.w*=t,s},t.prototype.normalize=function(t){t||(t=this);var s=this.length();return 1===s?this:0===s?(t.x*=0,t.y*=0,t.z*=0,t.w*=0,t):(s=1/s,t.x*=s,t.y*=s,t.z*=s,t.w*=s,t)},t.prototype.multiplyMat4=function(t,s){return s||(s=this),t.multiplyVec4(this,s)},t.mix=function(s,e,i,u){return u||(u=new t),u.x=s.x+i*(e.x-s.x),u.y=s.y+i*(e.y-s.y),u.z=s.z+i*(e.z-s.z),u.w=s.w+i*(e.w-s.w),u},t.sum=function(s,e,i){return i||(i=new t),i.x=s.x+e.x,i.y=s.y+e.y,i.z=s.z+e.z,i.w=s.w+e.w,i},t.difference=function(s,e,i){return i||(i=new t),i.x=s.x-e.x,i.y=s.y-e.y,i.z=s.z-e.z,i.w=s.w-e.w,i},t.product=function(s,e,i){return i||(i=new t),i.x=s.x*e.x,i.y=s.y*e.y,i.z=s.z*e.z,i.w=s.w*e.w,i},t.quotient=function(s,e,i){return i||(i=new t),i.x=s.x/e.x,i.y=s.y/e.y,i.z=s.z/e.z,i.w=s.w/e.w,i},t.zero=new t([0,0,0,1]),t.one=new t([1,1,1,1]),t}(),e=function(){function t(t){this.values=new Float32Array(16),void 0!==t&&this.init(t)}return t.prototype.at=function(t){return this.values[t]},t.prototype.init=function(t){for(var s=0;s<16;s++)this.values[s]=t[s];return this},t.prototype.reset=function(){for(var t=0;t<16;t++)this.values[t]=0},t.prototype.copy=function(s){s||(s=new t);for(var e=0;e<16;e++)s.values[e]=this.values[e];return s},t.prototype.all=function(){for(var t=[],s=0;s<16;s++)t[s]=this.values[s];return t},t.prototype.row=function(t){return[this.values[4*t+0],this.values[4*t+1],this.values[4*t+2],this.values[4*t+3]]},t.prototype.col=function(t){return[this.values[t],this.values[t+4],this.values[t+8],this.values[t+12]]},t.prototype.equals=function(t,s){void 0===s&&(s=1e-5);for(var e=0;e<16;e++)if(Math.abs(this.values[e]-t.at(e))>s)return!1;return!0},t.prototype.determinant=function(){var t=this.values[0],s=this.values[1],e=this.values[2],i=this.values[3],u=this.values[4],a=this.values[5],n=this.values[6],r=this.values[7],h=this.values[8],l=this.values[9],o=this.values[10],v=this.values[11],y=this.values[12],p=this.values[13],c=this.values[14],f=this.values[15];return(t*a-s*u)*(o*f-v*c)-(t*n-e*u)*(l*f-v*p)+(t*r-i*u)*(l*c-o*p)+(s*n-e*a)*(h*f-v*y)-(s*r-i*a)*(h*c-o*y)+(e*r-i*n)*(h*p-l*y)},t.prototype.setIdentity=function(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=0,this.values[5]=1,this.values[6]=0,this.values[7]=0,this.values[8]=0,this.values[9]=0,this.values[10]=1,this.values[11]=0,this.values[12]=0,this.values[13]=0,this.values[14]=0,this.values[15]=1,this},t.prototype.transpose=function(){var t=this.values[1],s=this.values[2],e=this.values[3],i=this.values[6],u=this.values[7],a=this.values[11];return this.values[1]=this.values[4],this.values[2]=this.values[8],this.values[3]=this.values[12],this.values[4]=t,this.values[6]=this.values[9],this.values[7]=this.values[13],this.values[8]=s,this.values[9]=i,this.values[11]=this.values[14],this.values[12]=e,this.values[13]=u,this.values[14]=a,this},t.prototype.inverse=function(){var t=this.values[0],s=this.values[1],e=this.values[2],i=this.values[3],u=this.values[4],a=this.values[5],n=this.values[6],r=this.values[7],h=this.values[8],l=this.values[9],o=this.values[10],v=this.values[11],y=this.values[12],p=this.values[13],c=this.values[14],f=this.values[15],x=t*a-s*u,z=t*n-e*u,w=t*r-i*u,d=s*n-e*a,b=s*r-i*a,m=e*r-i*n,g=h*p-l*y,M=h*c-o*y,q=h*f-v*y,j=l*c-o*p,P=l*f-v*p,O=o*f-v*c,V=x*O-z*P+w*j+d*q-b*M+m*g;return V?(V=1/V,this.values[0]=(a*O-n*P+r*j)*V,this.values[1]=(-s*O+e*P-i*j)*V,this.values[2]=(p*m-c*b+f*d)*V,this.values[3]=(-l*m+o*b-v*d)*V,this.values[4]=(-u*O+n*q-r*M)*V,this.values[5]=(t*O-e*q+i*M)*V,this.values[6]=(-y*m+c*w-f*z)*V,this.values[7]=(h*m-o*w+v*z)*V,this.values[8]=(u*P-a*q+r*g)*V,this.values[9]=(-t*P+s*q-i*g)*V,this.values[10]=(y*b-p*w+f*x)*V,this.values[11]=(-h*b+l*w-v*x)*V,this.values[12]=(-u*j+a*M-n*g)*V,this.values[13]=(t*j-s*M+e*g)*V,this.values[14]=(-y*d+p*z-c*x)*V,this.values[15]=(h*d-l*z+o*x)*V,this):null},t.prototype.multiply=function(t){var s=this.values[0],e=this.values[1],i=this.values[2],u=this.values[3],a=this.values[4],n=this.values[5],r=this.values[6],h=this.values[7],l=this.values[8],o=this.values[9],v=this.values[10],y=this.values[11],p=this.values[12],c=this.values[13],f=this.values[14],x=this.values[15],z=t.at(0),w=t.at(1),d=t.at(2),b=t.at(3);return this.values[0]=z*s+w*a+d*l+b*p,this.values[1]=z*e+w*n+d*o+b*c,this.values[2]=z*i+w*r+d*v+b*f,this.values[3]=z*u+w*h+d*y+b*x,z=t.at(4),w=t.at(5),d=t.at(6),b=t.at(7),this.values[4]=z*s+w*a+d*l+b*p,this.values[5]=z*e+w*n+d*o+b*c,this.values[6]=z*i+w*r+d*v+b*f,this.values[7]=z*u+w*h+d*y+b*x,z=t.at(8),w=t.at(9),d=t.at(10),b=t.at(11),this.values[8]=z*s+w*a+d*l+b*p,this.values[9]=z*e+w*n+d*o+b*c,this.values[10]=z*i+w*r+d*v+b*f,this.values[11]=z*u+w*h+d*y+b*x,z=t.at(12),w=t.at(13),d=t.at(14),b=t.at(15),this.values[12]=z*s+w*a+d*l+b*p,this.values[13]=z*e+w*n+d*o+b*c,this.values[14]=z*i+w*r+d*v+b*f,this.values[15]=z*u+w*h+d*y+b*x,this},t.prototype.multiplyVec3=function(t){var s=t.x,e=t.y,i=t.z;return new a([this.values[0]*s+this.values[4]*e+this.values[8]*i+this.values[12],this.values[1]*s+this.values[5]*e+this.values[9]*i+this.values[13],this.values[2]*s+this.values[6]*e+this.values[10]*i+this.values[14]])},t.prototype.multiplyVec4=function(t,e){e||(e=new s);var i=t.x,u=t.y,a=t.z,n=t.w;return e.x=this.values[0]*i+this.values[4]*u+this.values[8]*a+this.values[12]*n,e.y=this.values[1]*i+this.values[5]*u+this.values[9]*a+this.values[13]*n,e.z=this.values[2]*i+this.values[6]*u+this.values[10]*a+this.values[14]*n,e.w=this.values[3]*i+this.values[7]*u+this.values[11]*a+this.values[15]*n,e},t.prototype.toMat3=function(){return new i([this.values[0],this.values[1],this.values[2],this.values[4],this.values[5],this.values[6],this.values[8],this.values[9],this.values[10]])},t.prototype.toInverseMat3=function(){var t=this.values[0],s=this.values[1],e=this.values[2],u=this.values[4],a=this.values[5],n=this.values[6],r=this.values[8],h=this.values[9],l=this.values[10],o=l*a-n*h,v=-l*u+n*r,y=h*u-a*r,p=t*o+s*v+e*y;return p?new i([o*(p=1/p),(-l*s+e*h)*p,(n*s-e*a)*p,v*p,(l*t-e*r)*p,(-n*t+e*u)*p,y*p,(-h*t+s*r)*p,(a*t-s*u)*p]):null},t.prototype.translate=function(t){var s=t.x,e=t.y,i=t.z;return this.values[12]+=this.values[0]*s+this.values[4]*e+this.values[8]*i,this.values[13]+=this.values[1]*s+this.values[5]*e+this.values[9]*i,this.values[14]+=this.values[2]*s+this.values[6]*e+this.values[10]*i,this.values[15]+=this.values[3]*s+this.values[7]*e+this.values[11]*i,this},t.prototype.scale=function(t){var s=t.x,e=t.y,i=t.z;return this.values[0]*=s,this.values[1]*=s,this.values[2]*=s,this.values[3]*=s,this.values[4]*=e,this.values[5]*=e,this.values[6]*=e,this.values[7]*=e,this.values[8]*=i,this.values[9]*=i,this.values[10]*=i,this.values[11]*=i,this},t.prototype.rotate=function(t,s){var e=s.x,i=s.y,u=s.z,a=Math.sqrt(e*e+i*i+u*u);if(!a)return null;1!==a&&(e*=a=1/a,i*=a,u*=a);var n=Math.sin(t),r=Math.cos(t),h=1-r,l=this.values[0],o=this.values[1],v=this.values[2],y=this.values[3],p=this.values[4],c=this.values[5],f=this.values[6],x=this.values[7],z=this.values[8],w=this.values[9],d=this.values[10],b=this.values[11],m=e*e*h+r,g=i*e*h+u*n,M=u*e*h-i*n,q=e*i*h-u*n,j=i*i*h+r,P=u*i*h+e*n,O=e*u*h+i*n,V=i*u*h-e*n,A=u*u*h+r;return this.values[0]=l*m+p*g+z*M,this.values[1]=o*m+c*g+w*M,this.values[2]=v*m+f*g+d*M,this.values[3]=y*m+x*g+b*M,this.values[4]=l*q+p*j+z*P,this.values[5]=o*q+c*j+w*P,this.values[6]=v*q+f*j+d*P,this.values[7]=y*q+x*j+b*P,this.values[8]=l*O+p*V+z*A,this.values[9]=o*O+c*V+w*A,this.values[10]=v*O+f*V+d*A,this.values[11]=y*O+x*V+b*A,this},t.frustum=function(s,e,i,u,a,n){var r=e-s,h=u-i,l=n-a;return new t([2*a/r,0,0,0,0,2*a/h,0,0,(e+s)/r,(u+i)/h,-(n+a)/l,-1,0,0,-n*a*2/l,0])},t.perspective=function(s,e,i,u){var a=i*Math.tan(s*Math.PI/360),n=a*e;return t.frustum(-n,n,-a,a,i,u)},t.orthographic=function(s,e,i,u,a,n){var r=e-s,h=u-i,l=n-a;return new t([2/r,0,0,0,0,2/h,0,0,0,0,-2/l,0,-(s+e)/r,-(u+i)/h,-(n+a)/l,1])},t.lookAt=function(s,e,i){if(void 0===i&&(i=a.up),s.equals(e))return this.identity;var u=a.difference(s,e).normalize(),n=a.cross(i,u).normalize(),r=a.cross(u,n).normalize();return new t([n.x,r.x,u.x,0,n.y,r.y,u.y,0,n.z,r.z,u.z,0,-a.dot(n,s),-a.dot(r,s),-a.dot(u,s),1])},t.product=function(s,e,i){var u=s.at(0),a=s.at(1),n=s.at(2),r=s.at(3),h=s.at(4),l=s.at(5),o=s.at(6),v=s.at(7),y=s.at(8),p=s.at(9),c=s.at(10),f=s.at(11),x=s.at(12),z=s.at(13),w=s.at(14),d=s.at(15),b=e.at(0),m=e.at(1),g=e.at(2),M=e.at(3),q=e.at(4),j=e.at(5),P=e.at(6),O=e.at(7),V=e.at(8),A=e.at(9),I=e.at(10),F=e.at(11),L=e.at(12),k=e.at(13),D=e.at(14),Q=e.at(15);return i?(i.init([b*u+m*h+g*y+M*x,b*a+m*l+g*p+M*z,b*n+m*o+g*c+M*w,b*r+m*v+g*f+M*d,q*u+j*h+P*y+O*x,q*a+j*l+P*p+O*z,q*n+j*o+P*c+O*w,q*r+j*v+P*f+O*d,V*u+A*h+I*y+F*x,V*a+A*l+I*p+F*z,V*n+A*o+I*c+F*w,V*r+A*v+I*f+F*d,L*u+k*h+D*y+Q*x,L*a+k*l+D*p+Q*z,L*n+k*o+D*c+Q*w,L*r+k*v+D*f+Q*d]),i):new t([b*u+m*h+g*y+M*x,b*a+m*l+g*p+M*z,b*n+m*o+g*c+M*w,b*r+m*v+g*f+M*d,q*u+j*h+P*y+O*x,q*a+j*l+P*p+O*z,q*n+j*o+P*c+O*w,q*r+j*v+P*f+O*d,V*u+A*h+I*y+F*x,V*a+A*l+I*p+F*z,V*n+A*o+I*c+F*w,V*r+A*v+I*f+F*d,L*u+k*h+D*y+Q*x,L*a+k*l+D*p+Q*z,L*n+k*o+D*c+Q*w,L*r+k*v+D*f+Q*d])},t.identity=(new t).setIdentity(),t}(),i=function(){function t(t){this.values=new Float32Array(9),void 0!==t&&this.init(t)}return t.prototype.at=function(t){return this.values[t]},t.prototype.init=function(t){for(var s=0;s<9;s++)this.values[s]=t[s];return this},t.prototype.reset=function(){for(var t=0;t<9;t++)this.values[t]=0},t.prototype.copy=function(s){s||(s=new t);for(var e=0;e<9;e++)s.values[e]=this.values[e];return s},t.prototype.all=function(){for(var t=[],s=0;s<9;s++)t[s]=this.values[s];return t},t.prototype.row=function(t){return[this.values[3*t+0],this.values[3*t+1],this.values[3*t+2]]},t.prototype.col=function(t){return[this.values[t],this.values[t+3],this.values[t+6]]},t.prototype.equals=function(t,s){void 0===s&&(s=1e-5);for(var e=0;e<9;e++)if(Math.abs(this.values[e]-t.at(e))>s)return!1;return!0},t.prototype.determinant=function(){var t=this.values[0],s=this.values[1],e=this.values[2],i=this.values[3],u=this.values[4],a=this.values[5],n=this.values[6],r=this.values[7],h=this.values[8];return t*(h*u-a*r)+s*(-h*i+a*n)+e*(r*i-u*n)},t.prototype.setIdentity=function(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=1,this.values[5]=0,this.values[6]=0,this.values[7]=0,this.values[8]=1,this},t.prototype.transpose=function(){var t=this.values[1],s=this.values[2],e=this.values[5];return this.values[1]=this.values[3],this.values[2]=this.values[6],this.values[3]=t,this.values[5]=this.values[7],this.values[6]=s,this.values[7]=e,this},t.prototype.inverse=function(){var t=this.values[0],s=this.values[1],e=this.values[2],i=this.values[3],u=this.values[4],a=this.values[5],n=this.values[6],r=this.values[7],h=this.values[8],l=h*u-a*r,o=-h*i+a*n,v=r*i-u*n,y=t*l+s*o+e*v;return y?(y=1/y,this.values[0]=l*y,this.values[1]=(-h*s+e*r)*y,this.values[2]=(a*s-e*u)*y,this.values[3]=o*y,this.values[4]=(h*t-e*n)*y,this.values[5]=(-a*t+e*i)*y,this.values[6]=v*y,this.values[7]=(-r*t+s*n)*y,this.values[8]=(u*t-s*i)*y,this):null},t.prototype.multiply=function(t){var s=this.values[0],e=this.values[1],i=this.values[2],u=this.values[3],a=this.values[4],n=this.values[5],r=this.values[6],h=this.values[7],l=this.values[8],o=t.at(0),v=t.at(1),y=t.at(2),p=t.at(3),c=t.at(4),f=t.at(5),x=t.at(6),z=t.at(7),w=t.at(8);return this.values[0]=o*s+v*u+y*r,this.values[1]=o*e+v*a+y*h,this.values[2]=o*i+v*n+y*l,this.values[3]=p*s+c*u+f*r,this.values[4]=p*e+c*a+f*h,this.values[5]=p*i+c*n+f*l,this.values[6]=x*s+z*u+w*r,this.values[7]=x*e+z*a+w*h,this.values[8]=x*i+z*n+w*l,this},t.prototype.multiplyVec2=function(t,s){var e=t.x,i=t.y;return s?(s.xy=[e*this.values[0]+i*this.values[3]+this.values[6],e*this.values[1]+i*this.values[4]+this.values[7]],s):new n([e*this.values[0]+i*this.values[3]+this.values[6],e*this.values[1]+i*this.values[4]+this.values[7]])},t.prototype.multiplyVec3=function(t,s){var e=t.x,i=t.y,u=t.z;return s?(s.xyz=[e*this.values[0]+i*this.values[3]+u*this.values[6],e*this.values[1]+i*this.values[4]+u*this.values[7],e*this.values[2]+i*this.values[5]+u*this.values[8]],s):new a([e*this.values[0]+i*this.values[3]+u*this.values[6],e*this.values[1]+i*this.values[4]+u*this.values[7],e*this.values[2]+i*this.values[5]+u*this.values[8]])},t.prototype.toMat4=function(t){return t?(t.init([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1]),t):new e([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1])},t.prototype.toQuat=function(){var t=this.values[0],s=this.values[1],e=this.values[2],i=this.values[3],a=this.values[4],n=this.values[5],r=this.values[6],h=this.values[7],l=this.values[8],o=t-a-l,v=a-t-l,y=l-t-a,p=0,c=t+a+l;o>c&&(c=o,p=1),v>c&&(c=v,p=2),y>c&&(c=y,p=3);var f=.5*Math.sqrt(c+1),x=.25/f,z=new u;switch(p){case 0:z.w=f,z.x=(n-h)*x,z.y=(r-e)*x,z.z=(s-i)*x;break;case 1:z.w=(n-h)*x,z.x=f,z.y=(s+i)*x,z.z=(r+e)*x;break;case 2:z.w=(r-e)*x,z.x=(s+i)*x,z.y=f,z.z=(n+h)*x;break;case 3:z.w=(s-i)*x,z.x=(r+e)*x,z.y=(n+h)*x,z.z=f}return z},t.prototype.rotate=function(t,s){var e=s.x,i=s.y,u=s.z,a=Math.sqrt(e*e+i*i+u*u);if(!a)return null;1!==a&&(e*=a=1/a,i*=a,u*=a);var n=Math.sin(t),r=Math.cos(t),h=1-r,l=this.values[0],o=this.values[1],v=this.values[2],y=this.values[4],p=this.values[5],c=this.values[6],f=this.values[8],x=this.values[9],z=this.values[10],w=e*e*h+r,d=i*e*h+u*n,b=u*e*h-i*n,m=e*i*h-u*n,g=i*i*h+r,M=u*i*h+e*n,q=e*u*h+i*n,j=i*u*h-e*n,P=u*u*h+r;return this.values[0]=l*w+y*d+f*b,this.values[1]=o*w+p*d+x*b,this.values[2]=v*w+c*d+z*b,this.values[3]=l*m+y*g+f*M,this.values[4]=o*m+p*g+x*M,this.values[5]=v*m+c*g+z*M,this.values[6]=l*q+y*j+f*P,this.values[7]=o*q+p*j+x*P,this.values[8]=v*q+c*j+z*P,this},t.product=function(s,e,i){var u=s.at(0),a=s.at(1),n=s.at(2),r=s.at(3),h=s.at(4),l=s.at(5),o=s.at(6),v=s.at(7),y=s.at(8),p=e.at(0),c=e.at(1),f=e.at(2),x=e.at(3),z=e.at(4),w=e.at(5),d=e.at(6),b=e.at(7),m=e.at(8);return i?(i.init([p*u+c*r+f*o,p*a+c*h+f*v,p*n+c*l+f*y,x*u+z*r+w*o,x*a+z*h+w*v,x*n+z*l+w*y,d*u+b*r+m*o,d*a+b*h+m*v,d*n+b*l+m*y]),i):new t([p*u+c*r+f*o,p*a+c*h+f*v,p*n+c*l+f*y,x*u+z*r+w*o,x*a+z*h+w*v,x*n+z*l+w*y,d*u+b*r+m*o,d*a+b*h+m*v,d*n+b*l+m*y])},t.identity=(new t).setIdentity(),t}(),u=function(){function t(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}return Object.defineProperty(t.prototype,"x",{get:function(){return this.values[0]},set:function(t){this.values[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.values[1]},set:function(t){this.values[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.values[2]},set:function(t){this.values[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this.values[3]},set:function(t){this.values[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xyzw",{get:function(){return[this.values[0],this.values[1],this.values[2],this.values[3]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]},enumerable:!0,configurable:!0}),t.prototype.at=function(t){return this.values[t]},t.prototype.reset=function(){for(var t=0;t<4;t++)this.values[t]=0},t.prototype.copy=function(s){s||(s=new t);for(var e=0;e<4;e++)s.values[e]=this.values[e];return s},t.prototype.roll=function(){var t=this.x,s=this.y,e=this.z,i=this.w;return Math.atan2(2*(t*s+i*e),i*i+t*t-s*s-e*e)},t.prototype.pitch=function(){var t=this.x,s=this.y,e=this.z,i=this.w;return Math.atan2(2*(s*e+i*t),i*i-t*t-s*s+e*e)},t.prototype.yaw=function(){return Math.asin(2*(this.x*this.z-this.w*this.y))},t.prototype.equals=function(t,s){void 0===s&&(s=1e-5);for(var e=0;e<4;e++)if(Math.abs(this.values[e]-t.at(e))>s)return!1;return!0},t.prototype.setIdentity=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},t.prototype.calculateW=function(){var t=this.x,s=this.y,e=this.z;return this.w=-Math.sqrt(Math.abs(1-t*t-s*s-e*e)),this},t.prototype.inverse=function(){var s=t.dot(this,this);if(!s)return this.xyzw=[0,0,0,0],this;var e=s?1/s:0;return this.x*=-e,this.y*=-e,this.z*=-e,this.w*=e,this},t.prototype.conjugate=function(){return this.values[0]*=-1,this.values[1]*=-1,this.values[2]*=-1,this},t.prototype.length=function(){var t=this.x,s=this.y,e=this.z,i=this.w;return Math.sqrt(t*t+s*s+e*e+i*i)},t.prototype.normalize=function(t){t||(t=this);var s=this.x,e=this.y,i=this.z,u=this.w,a=Math.sqrt(s*s+e*e+i*i+u*u);return a?(a=1/a,t.x=s*a,t.y=e*a,t.z=i*a,t.w=u*a,t):(t.x=0,t.y=0,t.z=0,t.w=0,t)},t.prototype.add=function(t){for(var s=0;s<4;s++)this.values[s]+=t.at(s);return this},t.prototype.multiply=function(t){var s=this.values[0],e=this.values[1],i=this.values[2],u=this.values[3],a=t.x,n=t.y,r=t.z,h=t.w;return this.x=s*h+u*a+e*r-i*n,this.y=e*h+u*n+i*a-s*r,this.z=i*h+u*r+s*n-e*a,this.w=u*h-s*a-e*n-i*r,this},t.prototype.multiplyVec3=function(t,s){s||(s=new a);var e=t.x,i=t.y,u=t.z,n=this.x,r=this.y,h=this.z,l=this.w,o=l*e+r*u-h*i,v=l*i+h*e-n*u,y=l*u+n*i-r*e,p=-n*e-r*i-h*u;return s.x=o*l+p*-n+v*-h-y*-r,s.y=v*l+p*-r+y*-n-o*-h,s.z=y*l+p*-h+o*-r-v*-n,s},t.prototype.toMat3=function(t){t||(t=new i);var s=this.x,e=this.y,u=this.z,a=this.w,n=s+s,r=e+e,h=u+u,l=s*n,o=s*r,v=s*h,y=e*r,p=e*h,c=u*h,f=a*n,x=a*r,z=a*h;return t.init([1-(y+c),o+z,v-x,o-z,1-(l+c),p+f,v+x,p-f,1-(l+y)]),t},t.prototype.toMat4=function(t){t||(t=new e);var s=this.x,i=this.y,u=this.z,a=this.w,n=s+s,r=i+i,h=u+u,l=s*n,o=s*r,v=s*h,y=i*r,p=i*h,c=u*h,f=a*n,x=a*r,z=a*h;return t.init([1-(y+c),o+z,v-x,0,o-z,1-(l+c),p+f,0,v+x,p-f,1-(l+y),0,0,0,0,1]),t},t.dot=function(t,s){return t.x*s.x+t.y*s.y+t.z*s.z+t.w*s.w},t.sum=function(s,e,i){return i||(i=new t),i.x=s.x+e.x,i.y=s.y+e.y,i.z=s.z+e.z,i.w=s.w+e.w,i},t.product=function(s,e,i){i||(i=new t);var u=s.x,a=s.y,n=s.z,r=s.w,h=e.x,l=e.y,o=e.z,v=e.w;return i.x=u*v+r*h+a*o-n*l,i.y=a*v+r*l+n*h-u*o,i.z=n*v+r*o+u*l-a*h,i.w=r*v-u*h-a*l-n*o,i},t.cross=function(s,e,i){i||(i=new t);var u=s.x,a=s.y,n=s.z,r=s.w,h=e.x,l=e.y,o=e.z,v=e.w;return i.x=r*o+n*v+u*l-a*h,i.y=r*v-u*h-a*l-n*o,i.z=r*h+u*v+a*o-n*l,i.w=r*l+a*v+n*h-u*o,i},t.shortMix=function(s,e,i,u){if(u||(u=new t),i<=0)return u.xyzw=s.xyzw,u;if(i>=1)return u.xyzw=e.xyzw,u;var a,n,r=t.dot(s,e),h=e.copy();if(r<0&&(h.inverse(),r=-r),r>.9999)a=1-i,n=0+i;else{var l=Math.sqrt(1-r*r),o=Math.atan2(l,r),v=1/l;a=Math.sin((1-i)*o)*v,n=Math.sin((0+i)*o)*v}return u.x=a*s.x+n*h.x,u.y=a*s.y+n*h.y,u.z=a*s.z+n*h.z,u.w=a*s.w+n*h.w,u},t.mix=function(s,e,i,u){u||(u=new t);var a=s.x*e.x+s.y*e.y+s.z*e.z+s.w*e.w;if(Math.abs(a)>=1)return u.xyzw=s.xyzw,u;var n=Math.acos(a),r=Math.sqrt(1-a*a);if(Math.abs(r)<.001)return u.x=.5*s.x+.5*e.x,u.y=.5*s.y+.5*e.y,u.z=.5*s.z+.5*e.z,u.w=.5*s.w+.5*e.w,u;var h=Math.sin((1-i)*n)/r,l=Math.sin(i*n)/r;return u.x=s.x*h+e.x*l,u.y=s.y*h+e.y*l,u.z=s.z*h+e.z*l,u.w=s.w*h+e.w*l,u},t.fromAxisAngle=function(s,e,i){i||(i=new t),e*=.5;var u=Math.sin(e);return i.x=s.x*u,i.y=s.y*u,i.z=s.z*u,i.w=Math.cos(e),i},t.identity=(new t).setIdentity(),t}(),a=function(){function t(t){this.values=new Float32Array(3),void 0!==t&&(this.xyz=t)}return Object.defineProperty(t.prototype,"x",{get:function(){return this.values[0]},set:function(t){this.values[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.values[1]},set:function(t){this.values[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.values[2]},set:function(t){this.values[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xyz",{get:function(){return[this.values[0],this.values[1],this.values[2]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]},enumerable:!0,configurable:!0}),t.prototype.at=function(t){return this.values[t]},t.prototype.reset=function(){this.x=0,this.y=0,this.z=0},t.prototype.copy=function(s){return s||(s=new t),s.x=this.x,s.y=this.y,s.z=this.z,s},t.prototype.negate=function(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t},t.prototype.equals=function(t,s){return void 0===s&&(s=1e-5),!(Math.abs(this.x-t.x)>s)&&(!(Math.abs(this.y-t.y)>s)&&!(Math.abs(this.z-t.z)>s))},t.prototype.length=function(){return Math.sqrt(this.squaredLength())},t.prototype.squaredLength=function(){var t=this.x,s=this.y,e=this.z;return t*t+s*s+e*e},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},t.prototype.scale=function(t,s){return s||(s=this),s.x*=t,s.y*=t,s.z*=t,s},t.prototype.normalize=function(t){t||(t=this);var s=this.length();return 1===s?this:0===s?(t.x=0,t.y=0,t.z=0,t):(s=1/s,t.x*=s,t.y*=s,t.z*=s,t)},t.prototype.multiplyByMat3=function(t,s){return s||(s=this),t.multiplyVec3(this,s)},t.prototype.multiplyByQuat=function(t,s){return s||(s=this),t.multiplyVec3(this,s)},t.prototype.toQuat=function(s){s||(s=new u);var e=new t,i=new t;return e.x=Math.cos(.5*this.x),i.x=Math.sin(.5*this.x),e.y=Math.cos(.5*this.y),i.y=Math.sin(.5*this.y),e.z=Math.cos(.5*this.z),i.z=Math.sin(.5*this.z),s.x=i.x*e.y*e.z-e.x*i.y*i.z,s.y=e.x*i.y*e.z+i.x*e.y*i.z,s.z=e.x*e.y*i.z-i.x*i.y*e.z,s.w=e.x*e.y*e.z+i.x*i.y*i.z,s},t.cross=function(s,e,i){i||(i=new t);var u=s.x,a=s.y,n=s.z,r=e.x,h=e.y,l=e.z;return i.x=a*l-n*h,i.y=n*r-u*l,i.z=u*h-a*r,i},t.dot=function(t,s){var e=t.x,i=t.y,u=t.z;return e*s.x+i*s.y+u*s.z},t.distance=function(t,s){s.x,t.x,s.y,t.y,s.z,t.z;return Math.sqrt(this.squaredDistance(t,s))},t.squaredDistance=function(t,s){var e=s.x-t.x,i=s.y-t.y,u=s.z-t.z;return e*e+i*i+u*u},t.direction=function(s,e,i){i||(i=new t);var u=s.x-e.x,a=s.y-e.y,n=s.z-e.z,r=Math.sqrt(u*u+a*a+n*n);return 0===r?(i.x=0,i.y=0,i.z=0,i):(r=1/r,i.x=u*r,i.y=a*r,i.z=n*r,i)},t.mix=function(s,e,i,u){return u||(u=new t),u.x=s.x+i*(e.x-s.x),u.y=s.y+i*(e.y-s.y),u.z=s.z+i*(e.z-s.z),u},t.sum=function(s,e,i){return i||(i=new t),i.x=s.x+e.x,i.y=s.y+e.y,i.z=s.z+e.z,i},t.difference=function(s,e,i){return i||(i=new t),i.x=s.x-e.x,i.y=s.y-e.y,i.z=s.z-e.z,i},t.product=function(s,e,i){return i||(i=new t),i.x=s.x*e.x,i.y=s.y*e.y,i.z=s.z*e.z,i},t.quotient=function(s,e,i){return i||(i=new t),i.x=s.x/e.x,i.y=s.y/e.y,i.z=s.z/e.z,i},t.zero=new t([0,0,0]),t.one=new t([1,1,1]),t.up=new t([0,1,0]),t.right=new t([1,0,0]),t.forward=new t([0,0,1]),t}(),n=function(){function t(t){this.values=new Float32Array(2),void 0!==t&&(this.xy=t)}return Object.defineProperty(t.prototype,"x",{get:function(){return this.values[0]},set:function(t){this.values[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.values[1]},set:function(t){this.values[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xy",{get:function(){return[this.values[0],this.values[1]]},set:function(t){this.values[0]=t[0],this.values[1]=t[1]},enumerable:!0,configurable:!0}),t.prototype.at=function(t){return this.values[t]},t.prototype.reset=function(){this.x=0,this.y=0},t.prototype.copy=function(s){return s||(s=new t),s.x=this.x,s.y=this.y,s},t.prototype.negate=function(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t},t.prototype.equals=function(t,s){return void 0===s&&(s=1e-5),!(Math.abs(this.x-t.x)>s)&&!(Math.abs(this.y-t.y)>s)},t.prototype.length=function(){return Math.sqrt(this.squaredLength())},t.prototype.squaredLength=function(){var t=this.x,s=this.y;return t*t+s*s},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.scale=function(t,s){return s||(s=this),s.x*=t,s.y*=t,s},t.prototype.normalize=function(t){t||(t=this);var s=this.length();return 1===s?this:0===s?(t.x=0,t.y=0,t):(s=1/s,t.x*=s,t.y*=s,t)},t.prototype.multiplyMat2=function(t,s){return s||(s=this),t.multiplyVec2(this,s)},t.prototype.multiplyMat3=function(t,s){return s||(s=this),t.multiplyVec2(this,s)},t.cross=function(t,s,e){e||(e=new a);var i=t.x,u=t.y,n=s.x,r=i*s.y-u*n;return e.x=0,e.y=0,e.z=r,e},t.dot=function(t,s){return t.x*s.x+t.y*s.y},t.distance=function(t,s){return Math.sqrt(this.squaredDistance(t,s))},t.squaredDistance=function(t,s){var e=s.x-t.x,i=s.y-t.y;return e*e+i*i},t.direction=function(s,e,i){i||(i=new t);var u=s.x-e.x,a=s.y-e.y,n=Math.sqrt(u*u+a*a);return 0===n?(i.x=0,i.y=0,i):(n=1/n,i.x=u*n,i.y=a*n,i)},t.mix=function(s,e,i,u){u||(u=new t);var a=s.x,n=s.y,r=e.x,h=e.y;return u.x=a+i*(r-a),u.y=n+i*(h-n),u},t.sum=function(s,e,i){return i||(i=new t),i.x=s.x+e.x,i.y=s.y+e.y,i},t.difference=function(s,e,i){return i||(i=new t),i.x=s.x-e.x,i.y=s.y-e.y,i},t.product=function(s,e,i){return i||(i=new t),i.x=s.x*e.x,i.y=s.y*e.y,i},t.quotient=function(s,e,i){return i||(i=new t),i.x=s.x/e.x,i.y=s.y/e.y,i},t.zero=new t([0,0]),t.one=new t([1,1]),t}(),r=function(){function t(t){this.values=new Float32Array(4),void 0!==t&&this.init(t)}return t.prototype.at=function(t){return this.values[t]},t.prototype.init=function(t){for(var s=0;s<4;s++)this.values[s]=t[s];return this},t.prototype.reset=function(){for(var t=0;t<4;t++)this.values[t]=0},t.prototype.copy=function(s){s||(s=new t);for(var e=0;e<4;e++)s.values[e]=this.values[e];return s},t.prototype.all=function(){for(var t=[],s=0;s<4;s++)t[s]=this.values[s];return t},t.prototype.row=function(t){return[this.values[2*t+0],this.values[2*t+1]]},t.prototype.col=function(t){return[this.values[t],this.values[t+2]]},t.prototype.equals=function(t,s){void 0===s&&(s=1e-5);for(var e=0;e<4;e++)if(Math.abs(this.values[e]-t.at(e))>s)return!1;return!0},t.prototype.determinant=function(){return this.values[0]*this.values[3]-this.values[2]*this.values[1]},t.prototype.setIdentity=function(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=1,this},t.prototype.transpose=function(){var t=this.values[1];return this.values[1]=this.values[2],this.values[2]=t,this},t.prototype.inverse=function(){var t=this.determinant();if(!t)return null;t=1/t;var s=this.values[0];return this.values[0]=t*this.values[3],this.values[1]=t*-this.values[1],this.values[2]=t*-this.values[2],this.values[3]=t*s,this},t.prototype.multiply=function(t){var s=this.values[0],e=this.values[1],i=this.values[2],u=this.values[3];return this.values[0]=s*t.at(0)+e*t.at(2),this.values[1]=s*t.at(1)+e*t.at(3),this.values[2]=i*t.at(0)+u*t.at(2),this.values[3]=i*t.at(1)+u*t.at(3),this},t.prototype.rotate=function(t){var s=this.values[0],e=this.values[1],i=this.values[2],u=this.values[3],a=Math.sin(t),n=Math.cos(t);return this.values[0]=s*n+e*a,this.values[1]=s*-a+e*n,this.values[2]=i*n+u*a,this.values[3]=i*-a+u*n,this},t.prototype.multiplyVec2=function(t,s){var e=t.x,i=t.y;return s?(s.xy=[e*this.values[0]+i*this.values[1],e*this.values[2]+i*this.values[3]],s):new n([e*this.values[0]+i*this.values[1],e*this.values[2]+i*this.values[3]])},t.prototype.scale=function(t){var s=this.values[0],e=this.values[1],i=this.values[2],u=this.values[3],a=t.x,n=t.y;return this.values[0]=s*a,this.values[1]=e*n,this.values[2]=i*a,this.values[3]=u*n,this},t.product=function(s,e,i){var u=s.at(0),a=s.at(1),n=s.at(2),r=s.at(3);return i?(i.init([u*e.at(0)+a*e.at(2),u*e.at(1)+a*e.at(3),n*e.at(0)+r*e.at(2),n*e.at(1)+r*e.at(3)]),i):new t([u*e.at(0)+a*e.at(2),u*e.at(1)+a*e.at(3),n*e.at(0)+r*e.at(2),n*e.at(1)+r*e.at(3)])},t.identity=(new t).setIdentity(),t}(),h={mat2:r,mat3:i,mat4:e,quat:u,vec2:n,vec3:a,vec4:s};t.mat2=r,t.mat3=i,t.mat4=e,t.quat=u,t.vec2=n,t.vec3=a,t.vec4=s,t.default=h,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=tsm.min.js.map
